<!DOCTYPE html>
<html lang="id" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <title>Pilih Kampanye untuk Pencairan Dana</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" />
        <link rel="stylesheet" th:href="@{/css/headerStyleOrganisasi.css}" />
        <link rel="stylesheet" th:href="@{/css/footerStyle.css}" />
        <link rel="icon" type="image/x-icon" th:href="@{/images/favicon.ico}" />
    </head>
    <body>
        <header th:replace="~{headerOrganisasi :: navbarOrganisasi}"></header>

        <main class="container my-5">
            <h1 class="fw-bold mb-3">Pencairan Dana</h1>
            <p class="lead text-muted mb-4">Pilih kampanye aktif yang dananya ingin Anda cairkan.</p>

            <form th:action="@{/pencairanDana}" method="get" class="row g-3 mb-4 align-items-center">
                <div class="col-md-9">
                    <select name="urutkan" class="form-select form-select-lg" onchange="this.form.submit()">
                        <option value="">Urutkan Berdasarkan</option>
                        <option value="dana_terkumpul_asc" th:selected="${urutkan == 'dana_terkumpul_asc'}">Dana Terkumpul (Sedikit ke Banyak)</option>
                        <option value="dana_terkumpul_desc" th:selected="${urutkan == 'dana_terkumpul_desc'}">Dana Terkumpul (Banyak ke Sedikit)</option>
                        <option value="sisa_hari_asc" th:selected="${urutkan == 'sisa_hari_asc'}">Sisa Hari (Mendesak)</option>
                        <option value="sisa_hari_desc" th:selected="${urutkan == 'sisa_hari_desc'}">Sisa Hari (Lama)</option>
                        <option value="target_asc" th:selected="${urutkan == 'target_asc'}">Target (Kecil ke Besar)</option>
                        <option value="target_desc" th:selected="${urutkan == 'target_desc'}">Target (Besar ke Kecil)</option>
                    </select>
                </div>
                <div class="col-md-3 d-grid">
                    <button type="submit" class="btn btn-primary btn-lg">Filter</button>
                </div>
            </form>

            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                <div th:if="${#lists.isEmpty(kampanyeList)}" class="col-12">
                    <div class="alert alert-info text-center">Tidak ada kampanye aktif yang dapat dicairkan saat ini.</div>
                </div>

                <div class="col" th:each="kampanye : ${kampanyeList}">
                    <div class="card h-100 shadow-sm">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title" th:text="${kampanye.judul_kampanye}">Judul Kampanye</h5>
                            <hr />
                            <div class="d-flex justify-content-between">
                                <span class="text-muted">Terkumpul</span>
                                <span class="fw-bold" th:text="'Rp ' + ${#numbers.formatDecimal(kampanye.dana_terkumpul, 0, 'POINT', 0, 'COMMA')}"></span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span class="text-muted">Target</span>
                                <span th:text="'Rp ' + ${#numbers.formatDecimal(kampanye.target_dana, 0, 'POINT', 0, 'COMMA')}"></span>
                            </div>
                            <div class="d-flex justify-content-between mt-2">
                                <span class="text-muted">Sisa Hari</span>
                                <span th:text="${kampanye.sisa_hari} + ' hari'"></span>
                            </div>
                            <a th:href="@{/pencairan-dana/form/{id}(id=${kampanye.id_kampanye})}" class="btn btn-success w-100 mt-auto">Ajukan Pencairan</a>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="logoutModalLabel" style="color: #2e5c4d">Konfirmasi Logout</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" style="color: #a1a1a1">Anda akan keluar dari sesi saat ini. Apakah anda yakin ingin melanjutkannya?</div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">BATAL</button>
                        <a th:href="@{/logout}" class="btn btn-danger">YA, LOGOUT</a>
                    </div>
                </div>
            </div>
        </div>

        <footer th:replace="~{footer :: footer}"></footer>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    </body>
</html>
