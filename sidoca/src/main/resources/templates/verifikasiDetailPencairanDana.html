<!DOCTYPE html>
<html lang="id" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <title>Detail Verifikasi Pencairan Dana</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" />
        <link rel="stylesheet" th:href="@{/css/headerStyleAdmin.css}" />
        <link rel="stylesheet" th:href="@{/css/footerStyle.css}" />
        <link rel="icon" type="image/x-icon" th:href="@{/images/favicon.ico}" />
        <link rel="stylesheet" th:href="@{/css/global-animations.css}" />
        <link rel="stylesheet" th:href="@{/css/enhanced-components.css}" />
    </head>
    <body>
        <header th:replace="~{headerAdmin :: navbarAdmin}"></header>

        <main class="container my-5">
            <h1 class="fw-bold mb-3">Verifikasi Pencairan Dana</h1>
            <p class="lead text-muted mb-4">Lihat detail nya dan lakukan verifikasi</p>

            <div class="row g-4">
                <div class="col-lg-8">
                    <div class="card shadow-sm">
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold mb-4">Detail Pengajuan</h5>
                            <div class="row mb-3">
                                <div class="col-sm-4 text-muted">ID Pengajuan</div>
                                <div class="col-sm-8" th:text="'#' + ${detail.idPencairan}">#ID12345</div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-sm-4 text-muted">Nama Organisasi</div>
                                <div class="col-sm-8" th:text="${detail.namaOrganisasi}">Yayasan Harapan Bangsa</div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-sm-4 text-muted">Tanggal Pengajuan</div>
                                <div class="col-sm-8" th:text="${#dates.format(detail.tanggalPengajuan, 'dd MMMM yyyy')}">12 Agustus 2023</div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4 text-muted">Jumlah Diajukan</div>
                                <div class="col-sm-8 fw-bold fs-5 text-success" th:text="'Rp ' + ${#numbers.formatDecimal(detail.jumlahDiajukan, 0, 'POINT', 0, 'COMMA')}">Rp 15.000.000</div>
                            </div>

                            <hr class="my-4" />

                            <h5 class="card-title fw-bold mb-4">Informasi Rekening Tujuan</h5>
                            <div class="row mb-3">
                                <div class="col-sm-4 text-muted">Nama Bank</div>
                                <div class="col-sm-8" th:text="${detail.namaBank}">Bank Central Asia (BCA)</div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-sm-4 text-muted">Nomor Rekening</div>
                                <div class="col-sm-8" th:text="${detail.nomorRekening}">1234567890</div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4 text-muted">Atas Nama</div>
                                <div class="col-sm-8" th:text="${detail.namaPemilikRekening}">Yayasan Harapan Bangsa</div>
                            </div>

                            <hr class="my-4" />

                            <h5 class="card-title fw-bold mb-3">Dokumen Pendukung</h5>
                            <div th:if="${!#lists.isEmpty(detail.buktiPendukung)}">
                                <div th:each="bukti : ${detail.buktiPendukung}" class="mb-2">
                                    <a th:href="@{${bukti}}" target="_blank" class="text-decoration-none">
                                        <i class="bi bi-file-earmark-text"></i>
                                        <span th:text="${bukti.substring(bukti.lastIndexOf('/') + 1)}">Surat Keterangan Yayasan.pdf</span>
                                    </a>
                                </div>
                            </div>
                            <p th:if="${#lists.isEmpty(detail.buktiPendukung)}" class="text-muted">Tidak ada dokumen pendukung yang diunggah.</p>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                    <div class="card shadow-sm mb-4">
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold">Deskripsi</h5>
                            <p class="text-muted" th:text="${detail.alasanPencairan}">Dana yang diajukan akan digunakan secara terencana dan transparan...</p>
                        </div>
                    </div>

                    <div class="card shadow-sm">
                        <div class="card-body p-4">
                            <h5 class="card-title fw-bold">Aksi Verifikasi</h5>
                            <form th:action="@{/verifikasiPencairanDana/proses}" method="post">
                                <input type="hidden" name="idPencairan" th:value="${detail.idPencairan}" />
                                <input type="hidden" name="idKampanye" th:value="${detail.idKampanye}" />
                                <input type="hidden" name="jumlahDiajukan" th:value="${detail.jumlahDiajukan}" />
                                <div class="mb-3">
                                    <label for="komentar" class="form-label">Catatan/Komentar untuk Organisasi (Opsional)</label>
                                    <textarea name="komentar" id="komentar" class="form-control" rows="4" placeholder="Tuliskan alasan penolakan atau pesan tambahan di sini..."></textarea>
                                </div>
                                <div class="d-grid gap-2">
                                    <button type="submit" name="action" value="tolak" class="btn btn-danger"><i class="bi bi-x-circle"></i> Tolak Pengajuan</button>
                                    <button type="submit" name="action" value="setuju" class="btn btn-success"><i class="bi bi-check-circle"></i> Setujui Pencairan</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content modal-content-enhanced">
                    <div class="modal-header modal-header-enhanced">
                        <h5 class="modal-title" id="logoutModalLabel">
                            <i class="bi bi-box-arrow-right me-2"></i>Konfirmasi Logout
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body modal-body-enhanced">
                        <p class="text-center">Anda akan keluar dari sesi saat ini. Apakah anda yakin ingin melanjutkannya?</p>
                    </div>
                    <div class="modal-footer modal-footer-enhanced">
                        <button type="button" class="btn btn-outline-enhanced" data-bs-dismiss="modal">BATAL</button>
                        <a th:href="@{/logout}" class="btn btn-secondary-enhanced" data-testid="confirm-logout-button">YA, LOGOUT</a>
                    </div>
                </div>
            </div>
        </div>

        <footer th:replace="~{footer :: footer}"></footer>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    </body>
</html>
