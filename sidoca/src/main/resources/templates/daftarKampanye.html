<!DOCTYPE html>
<html lang="id" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title th:text="${judul}">Daftar Kampanye</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" />
        <link rel="icon" type="image/x-icon" th:href="@{/images/favicon.ico}" />
        <link rel="stylesheet" th:href="@{/css/headerStyleDonatur.css}" />
        <link rel="stylesheet" th:href="@{/css/footerStyle.css}" />
        <link rel="stylesheet" th:href="@{/css/daftarKampanyeStyle.css}" />
    </head>
    <body>
        <header th:replace="~{headerDonatur :: navbarDonatur}"></header>

        <main class="container my-5">
            <div class="hero-section text-center p-5 mb-5 rounded-3">
                <h1 class="hero-title">Bantu Mereka yang Membutuhkan. <br />Mulai Berdonasi Hari Ini.</h1>
                <p class="hero-subtitle">Setiap donasi Anda membawa harapan baru bagi mereka. Mari bersama-sama menciptakan perubahan positif.</p>
            </div>

            <form th:action="@{/daftarKampanye}" method="get" class="row g-3 mb-4 align-items-center">
                <div class="col-md-8">
                    <div class="input-group">
                        <input type="search" name="keyword" class="form-control form-control-lg" placeholder="Cari judul atau nama organisasi..." th:value="${keyword}" />
                        <button class="btn btn-outline-secondary" type="submit"><i class="bi bi-search"></i></button>
                    </div>
                </div>
                <div class="col-md-4">
                    <select name="urutkan" class="form-select form-select-lg" onchange="this.form.submit()">
                        <option value="terbaru" th:selected="${urutkan == 'terbaru'}">Urutkan: Terbaru</option>
                        <option value="mendesak" th:selected="${urutkan == 'mendesak'}">Urutkan: Mendesak</option>
                        <option value="paling_sedikit" th:selected="${urutkan == 'paling_sedikit'}">Urutkan: Paling Sedikit Terkumpul</option>
                    </select>
                </div>
            </form>

            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                <div th:if="${#lists.isEmpty(kampanyeList)}" class="col-12">
                    <div class="alert alert-warning text-center" role="alert">
                        Tidak ada kampanye aktif yang ditemukan.
                    </div>
                </div>

                <div class="col" th:each="kampanye : ${kampanyeList}">
                    <div class="card h-100 campaign-card shadow-sm">
                        <div class="position-relative">
                            <img th:src="${kampanye.url_gambar != null ? kampanye.url_gambar : '/images/image.png'}" class="card-img-top" alt="Gambar Kampanye" />
                            <span class="sisa-hari-badge" th:text="'Sisa ' + ${kampanye.sisa_hari} + ' hari'"></span>
                        </div>
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title" th:text="${kampanye.judul_kampanye}">Judul Kampanye</h5>
                            <p class="organizer mb-3">
                                <i class="bi bi-person-check-fill"></i>
                                <span th:text="${kampanye.nama_organisasi}">Nama Organisasi</span>
                            </p>

                            <div class="progress mb-2" style="height: 10px">
                                <div class="progress-bar" role="progressbar" th:style="'width:' + ${kampanye.persentase_terkumpul} + '%'" th:aria-valuenow="${kampanye.persentase_terkumpul}" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>

                            <div class="d-flex justify-content-between dana-info">
                                <span>Terkumpul</span>
                                <span>Target</span>
                            </div>
                            <div class="d-flex justify-content-between dana-angka">
                                <span class="fw-bold" th:text="'Rp ' + ${#numbers.formatDecimal(kampanye.dana_terkumpul, 0, 'POINT', 0, 'COMMA')}"></span>
                                <span th:text="'Rp ' + ${#numbers.formatDecimal(kampanye.target_dana, 0, 'POINT', 0, 'COMMA')}"></span>
                            </div>

                            <a th:href="@{/kampanye/{id}(id=${kampanye.id_kampanye})}" class="btn btn-donasi w-100 mt-auto">Lihat Detail</a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-center mt-5">
                <a href="#" class="btn btn-lihat-semua">Lihat Semua Kampanye</a>
            </div>
        </main>

        <div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="logoutModalLabel" style="color: #2E5C4D">Konfirmasi Logout</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" style="color: #A1A1A1">Anda akan keluar dari sesi saat ini. Apakah anda yakin ingin melanjutkannya?</div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">BATAL</button>
                        <a th:href="@{/logout}" class="btn btn-danger">YA, LOGOUT</a>
                    </div>
                </div>
            </div>
        </div>

        <footer th:replace="~{footer :: footer}"></footer>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    </body>
</html>